<!DOCTYPE html>
<html lang="en-US">
<head>
<base href="../../../../">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Using Procedures and Functions</title>
<link rel="shortcut icon" href="media/navigation/favicon.ico">
<link type="text/css" href="normalize.css" rel="Stylesheet">
<link type="text/css" href="default.css" rel="Stylesheet">
<link type="text/css" href="prism.css" rel="Stylesheet">
<script type="text/javascript" src="polyfills.js"></script><script type="text/javascript" src="languages.js"></script><script type="text/javascript" src="fuzzysort.js"></script><script type="text/javascript" src="prism.js"></script><script type="text/javascript" src="help2.js" defer></script><script type="text/javascript" src="a11y-toggle.js" defer></script><script type="text/javascript" src="en-US/langnames.js" defer></script><script type="text/javascript" src="paginathing.js" defer></script><script type="text/javascript" src="en-US/bookmarks.js" defer></script><script type="text/javascript" src="en-US/contents.js" defer></script><script type="text/javascript" src="help.js" defer></script><meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body itemscope="true" itemtype="http://schema.org/TechArticle">
<div class="header-extrawurst">
<header><div class="logo-container"><a class="logo" href="en-US/text/shared/05/new_help.html"><div class="symbol"></div>
<p>LibreOffice 6.3 Help</p></a></div></header><div class="modules">
<button type="button" data-a11y-toggle="modules-nav" id="modules" onclick="setupModules('', 'en-US');">Module</button><nav id="modules-nav"></nav>
</div>
</div>
<aside class="rightside"><input id="accordion-1" name="accordion-menu" type="checkbox"><label for="accordion-1">Contents</label><div id="Contents" class="contents-treeview"></div></aside><aside class="leftside"><div id="Index">
<div class="index-label">Index  ðŸ”Žï¸Ž </div>
<div id="Bookmarks">
<input id="search-bar" type="text" class="search" placeholder="Search in chosen module"><nav class="index"></nav>
</div>
</div></aside><div id="DisplayArea" itemprop="articleBody">


<a name="prozedur"></a>
<a name="bm_id3149456"></a>
  <meta itemprop="keywords" content="procedures">
  <meta itemprop="keywords" content="functions,using">
  <meta itemprop="keywords" content="variables,passing to procedures and functions">
  <meta itemprop="keywords" content="parameters,for procedures and functions">
  <meta itemprop="keywords" content="parameters,passing by reference or value">
  <meta itemprop="keywords" content="variables,scope">
  <meta itemprop="keywords" content="scope of variables">
  <meta itemprop="keywords" content="GLOBAL variables">
  <meta itemprop="keywords" content="PUBLIC variables">
  <meta itemprop="keywords" content="PRIVATE variables">
  <meta itemprop="keywords" content="functions,return value type">
  <meta itemprop="keywords" content="return value type of functions">



<h1 itemprop="articleSection" id="hd_id3149456">Using Procedures and Functions</h1>
<p id="par_id3150767" class="paragraph">The following describes the basic use of procedures and functions in LibreOffice Basic.</p>

<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="Note Icon 
" title="Note Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p>When you create a new module, LibreOffice Basic automatically inserts a SUB called "Main". This default name has nothing to do with the order or the starting point of a LibreOffice Basic project. You can also safely rename this SUB.</p></div>
</div>
<br>
<div class="note">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/note.svg" alt="Note Icon 
" title="Note Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p>Some restrictions apply for the names of your public variables, subs, and functions. You must not use the same name as one of the modules of the same library.</p></div>
</div>
<br>
<p id="par_id3154124" class="paragraph">Procedures (SUBS) and functions (FUNCTIONS) help you maintaining a structured overview by separating a program into logical pieces.</p>
<p id="par_id3153193" class="paragraph">One benefit of procedures and functions is that, once you have developed a program code containing task components, you can use this code in another project.</p>

<h2 itemprop="articleSection" id="hd_id3153770">Passing Variables to Procedures (SUB) and Functions (FUNCTION)</h2>
<p id="par_id3155414" class="paragraph">Variables can be passed to both procedures and functions. The SUB or FUNCTION must be declared to expect parameters:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Sub SubName(Parameter1 As Type, Parameter2 As Type,...)
Program code
End Sub
</code></pre></div>
<p id="par_id3152577" class="paragraph">The SUB is called using the following syntax:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
SubName(Value1, Value2,...)
</code></pre></div>
<p id="par_id3147124" class="paragraph">The parameters passed to a SUB must fit to those specified in the SUB declaration.</p>
<p id="par_id3147397" class="paragraph">The same process applies to FUNCTIONS. In addition, functions always return a function result. The result of a function is defined by assigning the return value to the function name:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Function FunctionName(Parameter1 As Type, Parameter2 As Type,...) As Type
Program code
FunctionName=Result
End Function
</code></pre></div>
<p id="par_id3153839" class="paragraph">The FUNCTION is called using the following syntax:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Variable=FunctionName(Parameter1, Parameter2,...)
</code></pre></div>
<div class="tip">
<div class="noteicon"><img src="media/icon-themes/res/helpimg/tip.svg" alt="Tip Icon 
" title="Tip Icon 
" style="width:40px;height:40px;"></div>
<div class="notetext"><p>You can also use the fully qualified name to call a procedure or function:<br> <span class="literal">Library.Module.Macro()</span> <br> For example, to call the Autotext macro from the Gimmicks library, use the following command:<br> <span class="literal">Gimmicks.AutoText.Main()</span> </p></div>
</div>
<br>

<h2 itemprop="articleSection" id="hd_id3156276">Passing Variables by Value or Reference</h2>
<p id="par_id3155765" class="paragraph">Parameters can be passed to a SUB or a FUNCTION either by reference or by value. Unless otherwise specified, a parameter is always passed by reference. That means that a SUB or a FUNCTION gets the parameter and can read and modify its value.</p>
<p id="par_id3145640" class="paragraph">If you want to pass a parameter by value insert the key word "ByVal" in front of the parameter when you call a SUB or FUNCTION, for example:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Result = Function(ByVal Parameter)
</code></pre></div>
<p id="par_id3149258" class="paragraph">In this case, the original content of the parameter will not be modified by the FUNCTION since it only gets the value and not the parameter itself.</p>

<h2 itemprop="articleSection" id="hd_id3150982">Scope of Variables</h2>
<p id="par_id3149814" class="paragraph">A variable defined within a SUB or FUNCTION, only remains valid until the procedure is exited. This is known as a "local" variable. In many cases, you need a variable to be valid in all procedures, in every module of all libraries, or after a SUB or FUNCTION is exited.</p>

<h3 id="hd_id3154186">Declaring Variables Outside a SUB or FUNCTION</h3>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Global VarName As TYPENAME
</code></pre></div>
<p id="par_id3145258" class="paragraph">The variable is valid as long as the LibreOffice session lasts.</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Public VarName As TYPENAME
</code></pre></div>
<p id="par_id3150088" class="paragraph">The variable is valid in all modules.</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Private VarName As TYPENAME
</code></pre></div>
<p id="par_id3152994" class="paragraph">The variable is only valid in this module.</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Dim VarName As TYPENAME
</code></pre></div>
<p id="par_id3150368" class="paragraph">The variable is only valid in this module.</p>

<h3 id="hd_id5097506">Example for private variables</h3>
<p id="par_id8738975" class="paragraph">Enforce private variables to be private across modules by setting CompatibilityMode(true).</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
' ***** Module1 *****
Private myText As String
Sub initMyText
    myText = "Hello"
    Print "In module1 : ", myText
End Sub
 
' ***** Module2 *****
'Option Explicit
Sub demoBug
    CompatibilityMode( true )
    initMyText
    ' Now returns empty string
    ' (or raises error for Option Explicit)
    Print "Now in module2 : ", myText
End Sub
</code></pre></div>

<h3 id="hd_id3154368">Saving Variable Content after Exiting a SUB or FUNCTION</h3>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Static VarName As TYPENAME
</code></pre></div>
<p id="par_id3154486" class="paragraph">The variable retains its value until the next time the FUNCTION or SUB is entered. The declaration must exist inside a SUB or a FUNCTION.</p>

<h2 itemprop="articleSection" id="hd_id3155809">Specifying the Return Value Type of a FUNCTION</h2>
<p id="par_id3149404" class="paragraph">As with variables, include a type-declaration character after the function name, or the type indicated by "As" and the corresponding key word at the end of the parameter list to define the type of the function's return value, for example:</p>
<div class="bascode" itemscope="true" itemtype="http://schema.org/SoftwareSourceCode" itemprop="codeSampleType" content="snippet" data-tooltip="Click on text to copy to clipboard"><pre><code class="language-visual-basic line-numbers">
Function WordCount(WordText As String) As Integer
</code></pre></div>
</div>
<div class="google-donation"></div>
<footer><div id="DEBUG" class="debug">
<h3 class="bug">Help content debug info:</h3>
<p>This page is: <a href="https://opengrok.libreoffice.org/xref/help/source/text/sbasic/shared/01020300.xhp" target="_blank">/text/sbasic/shared/01020300.xhp</a></p>
<p>Title is: Using Procedures and Functions</p>
<p id="bm_module"></p>
<p id="bm_system"></p>
<p id="bm_HID"></p>
</div></footer>
</body>
</html>
